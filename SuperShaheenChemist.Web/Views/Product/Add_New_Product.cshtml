@model DropDownViewModels

<div class="content-wrapper">
    <!-- pages navigates here -->
    <section class="content">
        <div class="row">
            <div class="col-xs-12 col-md-12 col-sm-12">
                <div class="box " id="print-section">
                    <div class="box-header">
                        <h3 class="box-title">
                            <i class="fa fa-plus" aria-hidden="true"></i>
                            Add New Product
                        </h3>
                    </div>
                    <form id="createProduct">
                        <div class="box-body ">
                            <h4 class="purchase-heading"> <i class="fa fa-check-circle"></i> Product Info</h4>
                            <div class="row">
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label>Product Name:</label>
                                        <input type="text" name="ProductName" value="" class="form-control input-lg" placeholder="e.g Panadol" reqiured="" />
                                    </div>
                                    <small>Name of the medicine or product ? </small>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label>Generic Name:</label>
                                        <input type="text" name="GenericName" value="" class="form-control input-lg" placeholder="e.g Paracetamol" reqiured="" />
                                    </div>
                                    <small>Name of the product ? </small>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label>Batch No:</label>
                                        <input type="text" name="BatchNo" value="" class="form-control input-lg" placeholder="e.g Batch No" reqiured="" />
                                    </div>
                                    <small>Sku or Batch No ?  </small>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label>Barcode:</label>
                                        <input type="text" name="BarCode" value="" class="form-control input-lg" placeholder="e.g 000025444255658" reqiured="" />
                                    </div>
                                </div>

                            </div>
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="form-group">
                                        <label>Description:</label>
                                        <textarea name="Description" class="form-control" rows="5">
								</textarea>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label> Type: <a onclick="show_modal_page('https://medix.spantiklab.com/product/popup/add_product_type_model')" href="javascript:void(0)"> (Add Type)</a></label>
                                        <select class="form-control select2" name="Type" id="category_id" style="width: 100%;">
                                            <option value="">Select Type</option>
                                            @foreach (var type in Model.medicinesTypes)
                                            {
                                                <option value="@type.Id">@type.Name</option>
                                            }
                                        </select>

                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label>Upload item image:</label>
                                        <div class="input-group">
                                            <input type="file" name="ImageURL" data-validate="required" class="form-control input-lg" data-message-required="Value Required">
                                        </div>
                                    </div>
                                    <small>Product scan or captured image ?</small>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label>Total Unit Qty: </label>
                                        <input type="number" name="UnitQuantity" value="" class="form-control input-lg" id="" placeholder="e.g 250" reqiured="" />
                                    </div>
                                    <small>Total quantity of single units </small>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label>Discount (%): </label>
                                        <input type="number" name="CustDiscount" value="" class="form-control input-lg" id="" placeholder="e.g 5" step="any" />
                                    </div>
                                    <small>Discount offer to customers in % </small>
                                </div>
                            </div>
                        </div>
                        <div class="box-body">
                            <h4 class="purchase-heading"> <i class="fa fa-check-circle"></i> Grouping</h4>
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label> Company: <a onclick="show_modal_page('https://medix.spantiklab.com/product/popup/add_brand_model')" href="javascript:void(0)"> (add Company)</a></label>
                                        <select class="form-control select2" name="CompanyName" id="category_id" style="width: 100%;">
                                            <option value="">Select Company</option>
                                            @foreach (var company in Model.companies)
                                            {
                                                <option value="@company.Id">@company.Name</option>
                                            }
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label> Distributor: <a onclick="show_modal_page('https://medix.spantiklab.com/product/popup/add_brand_sector')" href="javascript:void(0)"> (add Distributor)</a></label>
                                        <select class="form-control select2" name="Distributor" id="category_id" style="width: 100%;">
                                            <option value="">Select Distributor</option>
                                            @foreach (var distributor in Model.distributors)
                                            {
                                                <option value="@distributor.Id">@distributor.Name</option>
                                            }
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label> Category: <a onclick="show_modal_page('https://medix.spantiklab.com/product/popup/add_category_model')" href="javascript:void(0)"> (add category)</a></label>
                                        <select class="form-control select2" name="Category" id="category_id" style="width: 100%;">
                                            <option value="">Select Category</option>
                                            @foreach (var category in Model.categories)
                                            {
                                                <option value="@category.Id">@category.Name</option>
                                            }
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="box-body">
                            <h4 class="purchase-heading"><i class="fa fa-check-circle"></i> Extra information </h4>
                            <div class="row">
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label>Minimum stock level required:</label>
                                        <input type="number" name="MinStock" value="" class="form-control input-lg" placeholder="e.g 20" reqiured="" />
                                    </div>
                                    <small>Product alert indicator level ? </small>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label>Side Effects:</label>
                                        <input type="text" name="SideEffects" value="" class="form-control input-lg" id="sideeffects" placeholder="e.g avoid childrens" reqiured="" />
                                    </div>
                                    <small>Side effects of product ? </small>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label>Pack Size: </label>
                                        <input type="number" name="PackSize" value="" class="form-control input-lg" id="unit_per_pack" onkeyup="calculate_quantity()" placeholder="e.g 12" reqiured="" />
                                    </div>
                                    <small>Total number of products in each pack ? </small>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label>Unit Location in store: </label>
                                        <input type="text" name="Location" value="" class="form-control input-lg" placeholder="Top right corner" reqiured="" />
                                    </div>
                                    <small>Location where you stored this product in store. </small>
                                </div>
                            </div>
                        </div>
                        <div class="box-body">
                            <h4 class="purchase-heading"><i class="fa fa-check-circle"></i> Manufacturing & Expiry Date </h4>
                            <div class="row">
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label>Manufacturing Date :</label>
                                        <input type="date" name="ManufactureDate" value="" class="form-control input-lg" reqiured="" />
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label>Expiry Date :</label>
                                        <input type="date" name="ExpiryDate" value="" class="form-control input-lg" reqiured="" />
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="box-body">
                            <h4 class="purchase-heading"><i class="fa fa-check-circle"></i> Pricing & Costing </h4>
                            <div class="row">
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label>Unit Cost Price:</label>
                                        <input type="number" name="UnitCost" value="0" class="form-control input-lg" step="any" />
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label>Unit Retail Price:</label>
                                        <input type="number" name="UnitRetail" value="0" class="form-control input-lg" step="any" />
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label>Pack Cost Price:</label>
                                        <input type="number" name="PackCost" value="0" class="form-control input-lg" step="any" />
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label>Retail Cost Price :</label>
                                        <input type="number" name="PackRetailCost" value="0" class="form-control input-lg" step="any" />
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="box-body">
                            <h4 class="purchase-heading"><i class="fa fa-check-circle"></i> Taxing % </h4>
                            <div class="row">
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label>Sales Tax% :</label>
                                        <input type="number" name="SalesTax" value="" class="form-control input-lg" placeholder="2.30" />
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="box-body bg-setting-product">
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="form-group">
                                        <button name="saveBtn" class="btn btn-info btn-flat btn-lg pull-right" value="true"><i class="fa fa-floppy-o" aria-hidden="true"></i> Save Product</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </section>
    <!-- Bootstrap model  -->
    <style>
        .modal-backdrop {
            z-index: -1;
        }
    </style>

    <script type="text/javascript">
        function show_modal_page(url) {
            // SHOWING AJAX PRELOADER IMAGE
            jQuery('#page_model_view_data .modal-body').html('<div style="text-align:center;margin-top:200px;"><img src="https://medix.spantiklab.com/assets/img/loader-1.gif" style="height:25px;" /></div>');

            // LOADING THE AJAX MODAL
            jQuery('#page_model_view_data').modal('show', { backdrop: 'true' });

            // SHOW AJAX RESPONSE ON REQUEST SUCCESS
            $.ajax({
                url: url,
                success: function (response) {
                    //alert(response);
                    jQuery('#page_model_view_data .modal-body').html(response);
                }
            });
        }

        function add_new_row(url) {
            // SHOW AJAX RESPONSE ON REQUEST SUCCESS
            $.ajax({
                url: url,
                success: function (response) {
                    //alert(response);
                    jQuery('#transaction_table_body').append(response);
                }
            });
        }

    </script>

    <!-- (Ajax Modal)-->
    <div class="modal fade" id="page_model_view_data">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-body" style="height:500px; overflow:auto;">

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div><!-- Bootstrap model  ends-->
    <!-- product calculations  -->
    <script src="https://medix.spantiklab.com/assets/dist/js/backend/product.js"></script>		<!-- /.content -->
</div>
<script src="~/Client/plugins/jquery-validation/jquery.validate.min.js"></script>
<!-- /.content-wrapper -->
<!-- ./wrapper -->
<script>
    //To use validate insert the juery validate library also.
    $('#createProduct').validate({
        rules: {
            ProductName: {
                required: true,
                minlength: 1,
                maxlength: 100
            },
            Description: {
                maxlength: 500
            },
            GenericName: {
                required: true,
                maxlength: 100
            },
            BatchNo: {
                required: true,
                maxlength: 100
            },
            BarCode: {
                required: true,
                maxlength: 100
            },
            brand_id: {
                required: true
            },
            category:
            {
                required: true
            },
            distributor:
            {
                required: true
            }
            //Price:
            //{
            //    required: true,
            //    range: [1, 100000]
            //}
        },
        messages:
        {
            ProductName: {
                required: 'Name is required',
                minlength: 'Minimum length is 1',
                maxlength: 'Maximum length is 50'
            },
            Description: {
                maxlength: 'Max length is 100'
            }
            //Price: {
            //    required: 'Price is required',
            //    range: 'Price must be available within 1-100000'
            //}
        }
    });
    $("#saveBtn").click(function () {

        if ($("#createProduct").valid()) {
            $.ajax(
                {
                    type: 'post',
                    url: '/Product/Create',
                    data: $("#createProduct").serialize()
                }).done(function (response) {
                    $("#tableContainer").html(response);
                    $("#actionContainer").html("");

                }).fail(function (XMLHttpRequest, textStatus, errorThrown) {
                    alert("Fail");
                });
        }
        else {
            swal({
                title: "Warning",
                text: "Please enter all valid data required fields",
                icon: "warning",
                buttons: true,
                dangerMode: true,
            });
        }

    });
</script>